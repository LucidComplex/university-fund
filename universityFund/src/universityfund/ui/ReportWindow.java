/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package universityfund.ui;

import java.text.DateFormatSymbols;
import java.time.Instant;
import java.util.Calendar;
import java.util.Date;
import java.util.List;
import javax.persistence.EntityManager;
import universityfund.db.DbHelper;
import universityfund.db.models.ClassRepresentative;
import universityfund.db.models.Donor;
import universityfund.ui.tablemodels.MembersCategoryTableModel;

/**
 *
 * @author MiriamMarie
 */
public class ReportWindow extends javax.swing.JFrame implements UI {
    Donor selectedDonor;
    Donor selectRep;
    /**
     * Creates new form ReportWindown
     */
    public ReportWindow() {
        initComponents();
        selectedDonor = null;
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jTabbedPane1 = new javax.swing.JTabbedPane();
        annual_panel = new javax.swing.JPanel();
        jLabel6 = new javax.swing.JLabel();
        eachClass_button = new javax.swing.JButton();
        jLabel7 = new javax.swing.JLabel();
        jLabel8 = new javax.swing.JLabel();
        eachCategory_button = new javax.swing.JButton();
        jLabel9 = new javax.swing.JLabel();
        jLabel10 = new javax.swing.JLabel();
        eachDonor_button = new javax.swing.JButton();
        jButton6 = new javax.swing.JButton();
        jScrollPane2 = new javax.swing.JScrollPane();
        jTable2 = new javax.swing.JTable(new MembersCategoryTableModel());
        jLabel11 = new javax.swing.JLabel();
        monthly_panel = new javax.swing.JPanel();
        jLabel1 = new javax.swing.JLabel();
        jLabel2 = new javax.swing.JLabel();
        jLabel3 = new javax.swing.JLabel();
        jLabel4 = new javax.swing.JLabel();
        jLabel18 = new javax.swing.JLabel();
        jLabel19 = new javax.swing.JLabel();
        jLabel20 = new javax.swing.JLabel();
        jLabel21 = new javax.swing.JLabel();
        jLabel22 = new javax.swing.JLabel();
        jLabel23 = new javax.swing.JLabel();
        jLabel27 = new javax.swing.JLabel();
        jLabel28 = new javax.swing.JLabel();
        class_panel = new javax.swing.JPanel();
        jLabel5 = new javax.swing.JLabel();
        rep_combo = new javax.swing.JComboBox(getReps());
        jScrollPane1 = new javax.swing.JScrollPane();
        jTable1 = new javax.swing.JTable();
        sol_panel = new javax.swing.JPanel();
        solicit_button = new javax.swing.JButton();
        thanks_button = new javax.swing.JButton();
        thank_panel = new javax.swing.JPanel();
        jLabel12 = new javax.swing.JLabel();
        jScrollPane3 = new javax.swing.JScrollPane();
        jTextArea1 = new javax.swing.JTextArea();
        jLabel13 = new javax.swing.JLabel();
        jLabel14 = new javax.swing.JLabel();
        name1_text = new javax.swing.JLabel();
        invitation_panel = new javax.swing.JPanel();
        jLabel15 = new javax.swing.JLabel();
        jScrollPane4 = new javax.swing.JScrollPane();
        jTextArea2 = new javax.swing.JTextArea();
        jLabel16 = new javax.swing.JLabel();
        jLabel17 = new javax.swing.JLabel();
        form_button = new javax.swing.JButton();
        name2_text = new javax.swing.JLabel();
        set_button = new javax.swing.JButton();
        jLabel24 = new javax.swing.JLabel();
        name_text = new javax.swing.JLabel();
        jLabel25 = new javax.swing.JLabel();
        jLabel26 = new javax.swing.JLabel();

        setDefaultCloseOperation(javax.swing.WindowConstants.DISPOSE_ON_CLOSE);
        setTitle("REPORTS");
        setName("Form"); // NOI18N
        setResizable(false);

        jTabbedPane1.setBackground(new java.awt.Color(255, 255, 255));
        jTabbedPane1.setName("jTabbedPane1"); // NOI18N

        annual_panel.setBackground(new java.awt.Color(255, 255, 255));
        annual_panel.setName("annual_panel"); // NOI18N

        jLabel6.setText("Total Amount Raised:");
        jLabel6.setName("jLabel6"); // NOI18N

        eachClass_button.setText("Proceed>>");
        eachClass_button.setName("eachClass_button"); // NOI18N
        eachClass_button.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                eachClass_buttonActionPerformed(evt);
            }
        });

        jLabel7.setText("Total for each class:");
        jLabel7.setName("jLabel7"); // NOI18N

        jLabel8.setText("Total for each category:");
        jLabel8.setName("jLabel8"); // NOI18N

        eachCategory_button.setText("Proceed>>");
        eachCategory_button.setName("eachCategory_button"); // NOI18N
        eachCategory_button.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                eachCategory_buttonActionPerformed(evt);
            }
        });

        jLabel9.setText("Total for each donor circle:");
        jLabel9.setName("jLabel9"); // NOI18N

        jLabel10.setText("Class total for each donor circle:");
        jLabel10.setName("jLabel10"); // NOI18N

        eachDonor_button.setText("Proceed>>");
        eachDonor_button.setName("eachDonor_button"); // NOI18N
        eachDonor_button.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                eachDonor_buttonActionPerformed(evt);
            }
        });

        jButton6.setText("Proceed>>");
        jButton6.setName("jButton6"); // NOI18N

        jScrollPane2.setName("jScrollPane2"); // NOI18N

        jTable2.setName("jTable2"); // NOI18N
        jScrollPane2.setViewportView(jTable2);

        jLabel11.setText(getSum());
        jLabel11.setName("jLabel11"); // NOI18N

        javax.swing.GroupLayout annual_panelLayout = new javax.swing.GroupLayout(annual_panel);
        annual_panel.setLayout(annual_panelLayout);
        annual_panelLayout.setHorizontalGroup(
            annual_panelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(annual_panelLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(annual_panelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jScrollPane2)
                    .addGroup(annual_panelLayout.createSequentialGroup()
                        .addGroup(annual_panelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(annual_panelLayout.createSequentialGroup()
                                .addComponent(jLabel6)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(jLabel11))
                            .addGroup(annual_panelLayout.createSequentialGroup()
                                .addComponent(jLabel8)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(eachCategory_button)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                .addComponent(jLabel10)
                                .addGap(18, 18, 18)
                                .addComponent(jButton6))
                            .addGroup(annual_panelLayout.createSequentialGroup()
                                .addComponent(jLabel7)
                                .addGap(24, 24, 24)
                                .addComponent(eachClass_button)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                .addComponent(jLabel9)
                                .addGap(44, 44, 44)
                                .addComponent(eachDonor_button)))
                        .addGap(0, 136, Short.MAX_VALUE)))
                .addContainerGap())
        );
        annual_panelLayout.setVerticalGroup(
            annual_panelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, annual_panelLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jScrollPane2, javax.swing.GroupLayout.PREFERRED_SIZE, 221, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(18, 18, 18)
                .addGroup(annual_panelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel6)
                    .addComponent(jLabel11))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(annual_panelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel7)
                    .addComponent(eachClass_button)
                    .addComponent(jLabel9)
                    .addComponent(eachDonor_button))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(annual_panelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(eachCategory_button)
                    .addComponent(jLabel8)
                    .addComponent(jLabel10)
                    .addComponent(jButton6))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        jTabbedPane1.addTab("Annual Report to Donors", annual_panel);

        monthly_panel.setBackground(new java.awt.Color(255, 255, 255));
        monthly_panel.setName("monthly_panel"); // NOI18N

        jLabel1.setText("Month of:");
        jLabel1.setName("jLabel1"); // NOI18N

        jLabel2.setText(getMonth()
        );
        jLabel2.setName("jLabel2"); // NOI18N

        jLabel3.setText("Total pledges:");
        jLabel3.setName("jLabel3"); // NOI18N

        jLabel4.setText("Total gifts and donations:");
        jLabel4.setName("jLabel4"); // NOI18N

        jLabel18.setText("Percentage of pledges:");
        jLabel18.setName("jLabel18"); // NOI18N

        jLabel19.setText("Percentage of gifts and donations:");
        jLabel19.setName("jLabel19"); // NOI18N

        jLabel20.setText(getSumGifts());
        jLabel20.setName("jLabel20"); // NOI18N

        jLabel21.setText(getPercentGifts());
        jLabel21.setName("jLabel21"); // NOI18N

        jLabel22.setText("Total amount raised for this month:");
        jLabel22.setName("jLabel22"); // NOI18N

        jLabel23.setText(getSumForThisMonth());
        jLabel23.setName("jLabel23"); // NOI18N

        jLabel27.setText(getSumPledges());
        jLabel27.setName("jLabel27"); // NOI18N

        jLabel28.setText(getPercentPledges());
        jLabel28.setName("jLabel28"); // NOI18N

        javax.swing.GroupLayout monthly_panelLayout = new javax.swing.GroupLayout(monthly_panel);
        monthly_panel.setLayout(monthly_panelLayout);
        monthly_panelLayout.setHorizontalGroup(
            monthly_panelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(monthly_panelLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(monthly_panelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(monthly_panelLayout.createSequentialGroup()
                        .addComponent(jLabel1)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(jLabel2))
                    .addGroup(monthly_panelLayout.createSequentialGroup()
                        .addComponent(jLabel3)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(jLabel27))
                    .addGroup(monthly_panelLayout.createSequentialGroup()
                        .addComponent(jLabel4)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(jLabel20))
                    .addGroup(monthly_panelLayout.createSequentialGroup()
                        .addComponent(jLabel18)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(jLabel28))
                    .addGroup(monthly_panelLayout.createSequentialGroup()
                        .addComponent(jLabel19)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(jLabel21))
                    .addGroup(monthly_panelLayout.createSequentialGroup()
                        .addComponent(jLabel22)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(jLabel23)))
                .addContainerGap(383, Short.MAX_VALUE))
        );
        monthly_panelLayout.setVerticalGroup(
            monthly_panelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(monthly_panelLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(monthly_panelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(jLabel1, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jLabel2, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addGap(18, 18, 18)
                .addGroup(monthly_panelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel3)
                    .addComponent(jLabel27))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(monthly_panelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel18)
                    .addComponent(jLabel28))
                .addGap(15, 15, 15)
                .addGroup(monthly_panelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel4)
                    .addComponent(jLabel20))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(monthly_panelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel19)
                    .addComponent(jLabel21))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(monthly_panelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel22)
                    .addComponent(jLabel23))
                .addContainerGap(190, Short.MAX_VALUE))
        );

        jTabbedPane1.addTab("Monthly Report", monthly_panel);

        class_panel.setBackground(new java.awt.Color(255, 255, 255));
        class_panel.setName("class_panel"); // NOI18N

        jLabel5.setText("Class Representative:");
        jLabel5.setName("jLabel5"); // NOI18N

        rep_combo.setName("rep_combo"); // NOI18N
        rep_combo.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                rep_comboActionPerformed(evt);
            }
        });

        jScrollPane1.setName("jScrollPane1"); // NOI18N

        jTable1.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null}
            },
            new String [] {
                "Title 1", "Title 2", "Title 3", "Title 4"
            }
        ));
        jTable1.setName("jTable1"); // NOI18N
        jScrollPane1.setViewportView(jTable1);

        javax.swing.GroupLayout class_panelLayout = new javax.swing.GroupLayout(class_panel);
        class_panel.setLayout(class_panelLayout);
        class_panelLayout.setHorizontalGroup(
            class_panelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(class_panelLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(class_panelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jScrollPane1)
                    .addGroup(class_panelLayout.createSequentialGroup()
                        .addComponent(jLabel5)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(rep_combo, javax.swing.GroupLayout.PREFERRED_SIZE, 214, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(0, 290, Short.MAX_VALUE)))
                .addContainerGap())
        );
        class_panelLayout.setVerticalGroup(
            class_panelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(class_panelLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(class_panelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(rep_combo, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel5))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(jScrollPane1, javax.swing.GroupLayout.DEFAULT_SIZE, 288, Short.MAX_VALUE)
                .addContainerGap())
        );

        jTabbedPane1.addTab("Class Rep Contact List", class_panel);

        sol_panel.setBackground(new java.awt.Color(255, 255, 255));
        sol_panel.setName("sol_panel"); // NOI18N

        solicit_button.setText("Send Solicitation Letter");
        solicit_button.setName("solicit_button"); // NOI18N
        solicit_button.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                solicit_buttonActionPerformed(evt);
            }
        });

        thanks_button.setText("Send Thanking Letter");
        thanks_button.setName("thanks_button"); // NOI18N
        thanks_button.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                thanks_buttonActionPerformed(evt);
            }
        });

        thank_panel.setBackground(new java.awt.Color(255, 255, 204));
        thank_panel.setBorder(javax.swing.BorderFactory.createEtchedBorder());
        thank_panel.setName("thank_panel"); // NOI18N

        jLabel12.setText("Dear");
        jLabel12.setName("jLabel12"); // NOI18N

        jScrollPane3.setName("jScrollPane3"); // NOI18N

        jTextArea1.setEditable(false);
        jTextArea1.setColumns(20);
        jTextArea1.setFont(new java.awt.Font("Tahoma", 0, 11)); // NOI18N
        jTextArea1.setLineWrap(true);
        jTextArea1.setRows(5);
        jTextArea1.setText("This letter is to inform you that we have received the promised pledge and gift from you.\n\nThe Beta University would like to send you our deepest gratitudes for choosing to pledge this fiscal year. Hope you would continue pledging pledges to the next pledgable years.\n\n");
        jTextArea1.setWrapStyleWord(true);
        jTextArea1.setBorder(null);
        jTextArea1.setName("jTextArea1"); // NOI18N
        jScrollPane3.setViewportView(jTextArea1);

        jLabel13.setText("Yours truly,");
        jLabel13.setName("jLabel13"); // NOI18N

        jLabel14.setText("Suzanne Hayes");
        jLabel14.setName("jLabel14"); // NOI18N

        name1_text.setText(" ");
        name1_text.setName("name1_text"); // NOI18N

        javax.swing.GroupLayout thank_panelLayout = new javax.swing.GroupLayout(thank_panel);
        thank_panel.setLayout(thank_panelLayout);
        thank_panelLayout.setHorizontalGroup(
            thank_panelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(thank_panelLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(thank_panelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(thank_panelLayout.createSequentialGroup()
                        .addComponent(jLabel12)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(name1_text)
                        .addGap(0, 0, Short.MAX_VALUE))
                    .addComponent(jScrollPane3, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, 199, Short.MAX_VALUE)
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, thank_panelLayout.createSequentialGroup()
                        .addGap(0, 0, Short.MAX_VALUE)
                        .addGroup(thank_panelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jLabel13, javax.swing.GroupLayout.Alignment.TRAILING)
                            .addComponent(jLabel14, javax.swing.GroupLayout.Alignment.TRAILING))))
                .addContainerGap())
        );
        thank_panelLayout.setVerticalGroup(
            thank_panelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(thank_panelLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(thank_panelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel12)
                    .addComponent(name1_text))
                .addGap(18, 18, 18)
                .addComponent(jScrollPane3, javax.swing.GroupLayout.PREFERRED_SIZE, 163, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(jLabel13)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jLabel14)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        invitation_panel.setBackground(new java.awt.Color(204, 255, 204));
        invitation_panel.setBorder(javax.swing.BorderFactory.createEtchedBorder());
        invitation_panel.setName("invitation_panel"); // NOI18N

        jLabel15.setText("Dear ");
        jLabel15.setName("jLabel15"); // NOI18N

        jScrollPane4.setName("jScrollPane4"); // NOI18N

        jTextArea2.setEditable(false);
        jTextArea2.setColumns(20);
        jTextArea2.setFont(new java.awt.Font("Tahoma", 0, 11)); // NOI18N
        jTextArea2.setLineWrap(true);
        jTextArea2.setRows(5);
        jTextArea2.setText("This letter is to inform you that you are invited to place a pledge for this fiscal year for you are found to have close-ties with Beta University.\n\nAttached is a form, together with an envelope, for your response letter. The form is for you to fill up certain details about your pledge.\n\nHoping you would consider yourself to be part of the pledging people this pledgable year, and to the next pledgable years to come.");
        jTextArea2.setWrapStyleWord(true);
        jTextArea2.setBorder(null);
        jTextArea2.setName("jTextArea2"); // NOI18N
        jScrollPane4.setViewportView(jTextArea2);

        jLabel16.setText("Yours truly,");
        jLabel16.setName("jLabel16"); // NOI18N

        jLabel17.setText("Suzanne Hayes");
        jLabel17.setName("jLabel17"); // NOI18N

        form_button.setText("View Attached Form");
        form_button.setName("form_button"); // NOI18N
        form_button.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                form_buttonActionPerformed(evt);
            }
        });

        name2_text.setText(" ");
        name2_text.setName("name2_text"); // NOI18N

        javax.swing.GroupLayout invitation_panelLayout = new javax.swing.GroupLayout(invitation_panel);
        invitation_panel.setLayout(invitation_panelLayout);
        invitation_panelLayout.setHorizontalGroup(
            invitation_panelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(invitation_panelLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(invitation_panelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jScrollPane4, javax.swing.GroupLayout.DEFAULT_SIZE, 201, Short.MAX_VALUE)
                    .addGroup(invitation_panelLayout.createSequentialGroup()
                        .addComponent(jLabel15)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(name2_text)
                        .addGap(0, 0, Short.MAX_VALUE))
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, invitation_panelLayout.createSequentialGroup()
                        .addGap(0, 0, Short.MAX_VALUE)
                        .addGroup(invitation_panelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jLabel17, javax.swing.GroupLayout.Alignment.TRAILING)
                            .addComponent(jLabel16, javax.swing.GroupLayout.Alignment.TRAILING))))
                .addContainerGap())
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, invitation_panelLayout.createSequentialGroup()
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(form_button)
                .addGap(42, 42, 42))
        );
        invitation_panelLayout.setVerticalGroup(
            invitation_panelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(invitation_panelLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(invitation_panelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel15)
                    .addComponent(name2_text))
                .addGap(18, 18, 18)
                .addComponent(jScrollPane4, javax.swing.GroupLayout.PREFERRED_SIZE, 163, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 9, Short.MAX_VALUE)
                .addComponent(form_button)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(jLabel16)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jLabel17)
                .addContainerGap())
        );

        set_button.setText("Set...");
        set_button.setName("set_button"); // NOI18N
        set_button.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                set_buttonActionPerformed(evt);
            }
        });

        jLabel24.setText("Recipient:");
        jLabel24.setName("jLabel24"); // NOI18N

        name_text.setText(" ");
        name_text.setBorder(javax.swing.BorderFactory.createEtchedBorder());
        name_text.setName("name_text"); // NOI18N

        jLabel25.setText("Sample Thanking Letter");
        jLabel25.setName("jLabel25"); // NOI18N

        jLabel26.setText("Sample Solicitation Letter");
        jLabel26.setName("jLabel26"); // NOI18N

        javax.swing.GroupLayout sol_panelLayout = new javax.swing.GroupLayout(sol_panel);
        sol_panel.setLayout(sol_panelLayout);
        sol_panelLayout.setHorizontalGroup(
            sol_panelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, sol_panelLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(sol_panelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(name_text, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addGroup(sol_panelLayout.createSequentialGroup()
                        .addGroup(sol_panelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jLabel24)
                            .addComponent(set_button)
                            .addComponent(thanks_button, javax.swing.GroupLayout.PREFERRED_SIZE, 143, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(solicit_button))
                        .addGap(0, 9, Short.MAX_VALUE)))
                .addGap(8, 8, 8)
                .addGroup(sol_panelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(thank_panel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel25))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addGroup(sol_panelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(invitation_panel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel26))
                .addContainerGap())
        );
        sol_panelLayout.setVerticalGroup(
            sol_panelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(sol_panelLayout.createSequentialGroup()
                .addGroup(sol_panelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(sol_panelLayout.createSequentialGroup()
                        .addGap(30, 30, 30)
                        .addComponent(jLabel24)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(name_text)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(set_button)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(thanks_button)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(solicit_button))
                    .addGroup(sol_panelLayout.createSequentialGroup()
                        .addContainerGap()
                        .addGroup(sol_panelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jLabel25)
                            .addComponent(jLabel26))
                        .addGap(7, 7, 7)
                        .addGroup(sol_panelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(invitation_panel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                            .addComponent(thank_panel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))))
                .addContainerGap())
        );

        jTabbedPane1.addTab("Solicitation Letters", sol_panel);

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jTabbedPane1)
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jTabbedPane1)
        );

        pack();
    }// </editor-fold>//GEN-END:initComponents

    public Object[] getReps(){
        List <Donor> classReps;
        EntityManager em = DbHelper.getEntityManager();
        classReps = em.createQuery(
                "SELECT d.representative FROM ClassRepresentative d"          
        ).getResultList();
        return classReps.toArray() ;        
    }
    
    public String getMonth(){
        Calendar cal = Calendar.getInstance();
        cal.setTime(Date.from(Instant.now()));
        return getMonthForInt(cal.get(Calendar.MONTH));
    }
    
    public String getMonthForInt(int num) {
        String month = "wrong";
        DateFormatSymbols dfs = new DateFormatSymbols();
        String[] months = dfs.getMonths();
        if (num >= 0 && num <= 11 ) {
            month = months[num];
        }
        return month;
    }
    
    public String getSum(){
        EntityManager em = DbHelper.getEntityManager();
        Object sum = em.createQuery(
           "SELECT SUM (f.amount) FROM Funding f "
        ).getSingleResult();
        if (sum==null)
            return "0";
        else return sum.toString();
    }
    
    public String getSumPledges(){
        EntityManager em = DbHelper.getEntityManager();
        Object sum =  em.createNativeQuery(
              "SELECT SUM(AMOUNT) " +
                "FROM FUNDING JOIN PLEDGES ON FUNDINGID = FUNDING.ID JOIN DONOR ON DONORID = DONOR.ID " +
                "WHERE ((YEAR(FUNDING.DATEFUNDED) = ?1 " +
                "AND MONTH(FUNDING.DATEFUNDED) = ?2))"
        ).setParameter(1, java.time.Year.now().getValue()).
                setParameter(2, java.time.MonthDay.now().
                        getMonthValue()).getSingleResult();
        if (sum==null)
            return "0";
        else return sum.toString();
    }
    
    public String getPercentPledges(){
        String pledges = getSumPledges();
        String all = getSum();
        return String.format("%.2f", ((Double.valueOf(pledges)/
                                        Double.valueOf(all))*100))+"%";
    }

    public String getSumGifts(){
        EntityManager em = DbHelper.getEntityManager();
        Object sum = em.createNativeQuery(
              "SELECT SUM(AMOUNT) " +
                "FROM FUNDING JOIN DONATES ON FUNDINGID = FUNDING.ID JOIN DONOR ON DONORID = DONOR.ID " +
                "WHERE ((YEAR(FUNDING.DATEFUNDED) = ?1 " +
                "AND MONTH(FUNDING.DATEFUNDED) = ?2))"
        ).setParameter(1, java.time.Year.now().getValue()).
                setParameter(2, java.time.MonthDay.now().
                        getMonthValue()).getSingleResult();
        if (sum==null)
            return "0";
        else return sum.toString();
    }
    
    public String getSumForThisMonth(){
        EntityManager em = DbHelper.getEntityManager();
        Object sum = em.createNativeQuery(
              "SELECT SUM(AMOUNT) " +
                "FROM FUNDING " +
                "WHERE ((YEAR(FUNDING.DATEFUNDED) = ?1 " +
                "AND MONTH(FUNDING.DATEFUNDED) = ?2))"
        ).setParameter(1, java.time.Year.now().getValue()).
                setParameter(2, java.time.MonthDay.now().
                        getMonthValue()).getSingleResult();
        if (sum==null)
            return "0";
        else return sum.toString();
    }
    
    public String getPercentGifts(){
        String donations = getSumGifts();
        String all = getSum();
        return String.format("%.2f", (Double.valueOf(donations).floatValue()/Double.valueOf(all).floatValue())*100)+"%";
        
    }
    
    private void solicit_buttonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_solicit_buttonActionPerformed
        new MessageSent().setVisible(true);
    }//GEN-LAST:event_solicit_buttonActionPerformed

    private void eachDonor_buttonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_eachDonor_buttonActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_eachDonor_buttonActionPerformed

    private void eachCategory_buttonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_eachCategory_buttonActionPerformed
        new TotalEachCategoryWindow().setVisible(true);
    }//GEN-LAST:event_eachCategory_buttonActionPerformed

    private void eachClass_buttonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_eachClass_buttonActionPerformed
        new TotalEachClassWindow().setVisible(true);
    }//GEN-LAST:event_eachClass_buttonActionPerformed

    private void thanks_buttonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_thanks_buttonActionPerformed
        new MessageSent().setVisible(true);
        
    }//GEN-LAST:event_thanks_buttonActionPerformed

    private void set_buttonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_set_buttonActionPerformed
        // TODO add your handling code here:
        new SelectDonorWindow(this).setVisible(true);
    }//GEN-LAST:event_set_buttonActionPerformed

    private void form_buttonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_form_buttonActionPerformed
        new SampleForm().setVisible(true);
    }//GEN-LAST:event_form_buttonActionPerformed

    private void rep_comboActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_rep_comboActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_rep_comboActionPerformed

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JPanel annual_panel;
    private javax.swing.JPanel class_panel;
    private javax.swing.JButton eachCategory_button;
    private javax.swing.JButton eachClass_button;
    private javax.swing.JButton eachDonor_button;
    private javax.swing.JButton form_button;
    private javax.swing.JPanel invitation_panel;
    private javax.swing.JButton jButton6;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel10;
    private javax.swing.JLabel jLabel11;
    private javax.swing.JLabel jLabel12;
    private javax.swing.JLabel jLabel13;
    private javax.swing.JLabel jLabel14;
    private javax.swing.JLabel jLabel15;
    private javax.swing.JLabel jLabel16;
    private javax.swing.JLabel jLabel17;
    private javax.swing.JLabel jLabel18;
    private javax.swing.JLabel jLabel19;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel20;
    private javax.swing.JLabel jLabel21;
    private javax.swing.JLabel jLabel22;
    private javax.swing.JLabel jLabel23;
    private javax.swing.JLabel jLabel24;
    private javax.swing.JLabel jLabel25;
    private javax.swing.JLabel jLabel26;
    private javax.swing.JLabel jLabel27;
    private javax.swing.JLabel jLabel28;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JLabel jLabel5;
    private javax.swing.JLabel jLabel6;
    private javax.swing.JLabel jLabel7;
    private javax.swing.JLabel jLabel8;
    private javax.swing.JLabel jLabel9;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JScrollPane jScrollPane2;
    private javax.swing.JScrollPane jScrollPane3;
    private javax.swing.JScrollPane jScrollPane4;
    private javax.swing.JTabbedPane jTabbedPane1;
    private javax.swing.JTable jTable1;
    private javax.swing.JTable jTable2;
    private javax.swing.JTextArea jTextArea1;
    private javax.swing.JTextArea jTextArea2;
    private javax.swing.JPanel monthly_panel;
    private javax.swing.JLabel name1_text;
    private javax.swing.JLabel name2_text;
    private javax.swing.JLabel name_text;
    private javax.swing.JComboBox rep_combo;
    private javax.swing.JButton set_button;
    private javax.swing.JPanel sol_panel;
    private javax.swing.JButton solicit_button;
    private javax.swing.JPanel thank_panel;
    private javax.swing.JButton thanks_button;
    // End of variables declaration//GEN-END:variables

    @Override
    public void receiveIntent(Object intent) {
        EntityManager em = DbHelper.getEntityManager();
        selectedDonor = em.find(Donor.class, (long) intent);
        name_text.setText(selectedDonor.getName());
        name1_text.setText(selectedDonor.getName()+",");
        name2_text.setText(selectedDonor.getName()+",");
    }
}
